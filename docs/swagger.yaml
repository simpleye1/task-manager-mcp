components:
  schemas:
    domain.NovaExecutionStatus:
      type: string
      x-enum-varnames:
      - NovaStatusPending
      - NovaStatusRunning
      - NovaStatusCompleted
      - NovaStatusFailed
      - NovaStatusRejected
    domain.StepStatus:
      description: Optional, defaults to "running"
      type: string
      x-enum-varnames:
      - StepStatusRunning
      - StepStatusCompleted
      - StepStatusFailed
      - StepStatusSkipped
    domain.TaskStatus:
      type: string
      x-enum-varnames:
      - TaskStatusPending
      - TaskStatusInProgress
      - TaskStatusSucceeded
      - TaskStatusFailed
    domain.TicketStatus:
      type: string
      x-enum-varnames:
      - TicketStatusOpen
      - TicketStatusInProgress
      - TicketStatusInQA
    http.ActiveExecutionResponse:
      properties:
        data:
          $ref: '#/components/schemas/http.ExecutionInfo'
        success:
          type: boolean
      type: object
    http.CreateStepRequest:
      properties:
        message:
          type: string
        status:
          $ref: '#/components/schemas/domain.StepStatus'
        step_name:
          type: string
      required:
      - step_name
      type: object
    http.DashboardHealthResponse:
      properties:
        avg_latency_ms:
          type: number
        cpu_percent:
          type: number
        memory_percent:
          type: number
        memory_used_mb:
          type: number
        status:
          type: string
        timestamp:
          type: string
      type: object
    http.ErrorResponse:
      properties:
        error:
          type: string
        error_code:
          type: string
        success:
          type: boolean
        timestamp:
          type: string
      type: object
    http.ExecutionInfo:
      properties:
        comment_id:
          type: integer
        commit_sha:
          type: string
        completed_at:
          type: string
        confidence_level:
          type: integer
        confidence_reason:
          type: string
        cost_usd:
          type: number
        error_message:
          type: string
        execution_id:
          type: string
        raw_output:
          type: string
        sandbox_type:
          type: string
        session_id:
          type: string
        started_at:
          type: string
        status:
          $ref: '#/components/schemas/domain.NovaExecutionStatus'
        task_id:
          type: string
        trigger_type:
          type: string
        worktree_path:
          type: string
      type: object
    http.ExecutionResponse:
      properties:
        data:
          $ref: '#/components/schemas/http.ExecutionInfo'
        success:
          type: boolean
      type: object
    http.ExecutionsData:
      properties:
        executions:
          items:
            $ref: '#/components/schemas/http.ExecutionInfo'
          type: array
          uniqueItems: false
        limit:
          type: integer
        page:
          type: integer
        total_count:
          type: integer
      type: object
    http.ExecutionsResponse:
      properties:
        data:
          $ref: '#/components/schemas/http.ExecutionsData'
        success:
          type: boolean
      type: object
    http.HealthResponse:
      properties:
        status:
          type: string
        timestamp:
          type: string
        version:
          type: string
      type: object
    http.JIRATicketInfo:
      properties:
        assignee:
          type: string
        description:
          type: string
        key:
          type: string
        reporter:
          type: string
        status:
          $ref: '#/components/schemas/domain.TicketStatus'
        summary:
          type: string
      type: object
    http.LogsData:
      properties:
        lines:
          type: integer
        logs:
          items:
            type: string
          type: array
          uniqueItems: false
        total_lines:
          type: integer
      type: object
    http.LogsResponse:
      properties:
        data:
          $ref: '#/components/schemas/http.LogsData'
        success:
          type: boolean
      type: object
    http.PatchExecutionRequest:
      properties:
        session_id:
          type: string
        worktree_path:
          type: string
      type: object
    http.PatchStepRequest:
      properties:
        message:
          type: string
        status:
          description: Optional, defaults to "running"
          type: string
          x-enum-varnames:
          - StepStatusRunning
          - StepStatusCompleted
          - StepStatusFailed
          - StepStatusSkipped
      type: object
    http.StepInfo:
      properties:
        completed_at:
          type: string
        execution_id:
          type: string
        message:
          type: string
        started_at:
          type: string
        status:
          description: Optional, defaults to "running"
          type: string
          x-enum-varnames:
          - StepStatusRunning
          - StepStatusCompleted
          - StepStatusFailed
          - StepStatusSkipped
        step_id:
          type: string
        step_name:
          type: string
      type: object
    http.StepResponse:
      properties:
        data:
          $ref: '#/components/schemas/http.StepInfo'
        success:
          type: boolean
      type: object
    http.TaskInfo:
      properties:
        created_at:
          type: string
        failure_reason:
          type: string
        jira_info:
          $ref: '#/components/schemas/http.JIRATicketInfo'
        jira_ticket_id:
          type: string
        retry_count:
          type: integer
        status:
          $ref: '#/components/schemas/domain.TaskStatus'
        task_id:
          type: string
        updated_at:
          type: string
      type: object
    http.TaskStatusResponse:
      properties:
        data:
          $ref: '#/components/schemas/http.TaskInfo'
        success:
          type: boolean
      type: object
    http.TasksData:
      properties:
        tasks:
          items:
            $ref: '#/components/schemas/http.TaskInfo'
          type: array
          uniqueItems: false
        total_count:
          type: integer
      type: object
    http.TasksResponse:
      properties:
        data:
          $ref: '#/components/schemas/http.TasksData'
        success:
          type: boolean
      type: object
externalDocs:
  description: ""
  url: ""
info:
  title: ""
  version: ""
openapi: 3.1.0
paths:
  /api/dashboard/health:
    get:
      description: Get system health including CPU, memory usage, and API latency
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/http.DashboardHealthResponse'
          description: OK
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/http.ErrorResponse'
          description: Internal Server Error
      summary: Dashboard health check with system metrics
      tags:
      - health
  /api/executions:
    get:
      description: Query executions by task-id and status with pagination
      parameters:
      - description: Filter by task ID
        in: query
        name: task-id
        schema:
          type: string
      - description: Filter by status
        in: query
        name: status
        schema:
          enum:
          - running
          - completed
          - failed
          - rejected
          type: string
      - description: Page number (1-based)
        in: query
        name: page
        schema:
          default: 1
          minimum: 1
          type: integer
      - description: Number of results per page
        in: query
        name: limit
        schema:
          default: 20
          maximum: 100
          minimum: 1
          type: integer
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/http.ExecutionsResponse'
          description: OK
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/http.ErrorResponse'
          description: Bad Request
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/http.ErrorResponse'
          description: Internal Server Error
      summary: Query executions
      tags:
      - executions
  /api/executions/{execution-id}:
    patch:
      description: Partially update an execution (only provided fields are updated)
      parameters:
      - description: Execution ID
        in: path
        name: execution-id
        required: true
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/http.PatchExecutionRequest'
        description: Execution patch request
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/http.ExecutionResponse'
          description: OK
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/http.ErrorResponse'
          description: Bad Request
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/http.ErrorResponse'
          description: Not Found
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/http.ErrorResponse'
          description: Internal Server Error
      summary: Partially update execution
      tags:
      - executions
  /api/executions/{execution-id}/steps:
    post:
      description: Create a new execution step for the specified execution
      parameters:
      - description: Execution ID
        in: path
        name: execution-id
        required: true
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/http.CreateStepRequest'
        description: Step creation request
        required: true
      responses:
        "201":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/http.StepResponse'
          description: Created
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/http.ErrorResponse'
          description: Bad Request
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/http.ErrorResponse'
          description: Not Found
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/http.ErrorResponse'
          description: Internal Server Error
      summary: Create execution step
      tags:
      - steps
  /api/executions/{execution-id}/steps/{step-id}:
    patch:
      description: Partially update an execution step (only provided fields are updated)
      parameters:
      - description: Execution ID
        in: path
        name: execution-id
        required: true
        schema:
          type: string
      - description: Step ID
        in: path
        name: step-id
        required: true
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/http.PatchStepRequest'
        description: Step patch request
        required: true
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/http.StepResponse'
          description: OK
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/http.ErrorResponse'
          description: Bad Request
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/http.ErrorResponse'
          description: Not Found
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/http.ErrorResponse'
          description: Internal Server Error
      summary: Partially update step
      tags:
      - steps
  /api/health:
    get:
      description: Check if the Task Manager service is healthy
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/http.HealthResponse'
          description: OK
      summary: Health check
      tags:
      - health
  /api/logs:
    get:
      description: Retrieve task manager log entries with optional line limit
      parameters:
      - description: 'Number of lines to retrieve (default: 100, max: 1000)'
        in: query
        name: lines
        schema:
          type: integer
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/http.LogsResponse'
          description: OK
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/http.ErrorResponse'
          description: Bad Request
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/http.ErrorResponse'
          description: Internal Server Error
      summary: Get task manager logs
      tags:
      - logs
  /api/tasks:
    get:
      description: Get a list of all tasks, optionally filtered by status
      parameters:
      - description: Filter by status
        in: query
        name: status
        schema:
          enum:
          - running
          - success
          - failed
          type: string
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/http.TasksResponse'
          description: OK
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/http.ErrorResponse'
          description: Bad Request
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/http.ErrorResponse'
          description: Internal Server Error
      summary: List all tasks
      tags:
      - tasks
  /api/tasks/{task-id}:
    get:
      description: Get task information by task ID including JIRA ticket details
      parameters:
      - description: Task ID
        in: path
        name: task-id
        required: true
        schema:
          type: string
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/http.TaskStatusResponse'
          description: OK
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/http.ErrorResponse'
          description: Bad Request
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/http.ErrorResponse'
          description: Not Found
      summary: Get task by ID
      tags:
      - tasks
  /api/tasks/{task-id}/active-execution:
    get:
      description: Get the currently active (running) execution for a specific task
      parameters:
      - description: Task ID
        in: path
        name: task-id
        required: true
        schema:
          type: string
      responses:
        "200":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/http.ActiveExecutionResponse'
          description: OK
        "400":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/http.ErrorResponse'
          description: Bad Request
        "404":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/http.ErrorResponse'
          description: Not Found
        "500":
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/http.ErrorResponse'
          description: Internal Server Error
      summary: Get active execution by task ID
      tags:
      - tasks
